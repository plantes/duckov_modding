# RunWhileEating Mod 使用说明

**完整的安装、使用和故障排查指南**

---

## 📑 目录

1. [快速开始](#快速开始)
2. [详细安装步骤](#详细安装步骤)
3. [功能说明](#功能说明)
4. [调试功能](#调试功能)
5. [常见问题](#常见问题)
6. [进阶说明](#进阶说明)

---

## 快速开始

### 3 步安装

1. **下载并解压**
   - 获取 `RunWhileEating_v1.0.zip`
   - 解压到任意位置

2. **复制到游戏**
   - 复制 `RunWhileEating` 文件夹
   - 粘贴到 `{游戏目录}\Duckov_Data\Mods\`

3. **启用 Mod**
   - 启动游戏
   - 主菜单 → Mods → 启用"吃东西时可以跑"
   - 重启游戏

---

## 详细安装步骤

### 步骤 1：确认游戏版本

确保你的游戏版本为 **v1.0.26** 或更高版本。

**查看方法**：
- 游戏主菜单右下角显示版本号

### 步骤 2：找到游戏目录

**Steam 版本**：
1. 打开 Steam 客户端
2. 库 → 右键"逃离鸭科夫"
3. 管理 → 浏览本地文件

**其他版本**：
- 找到包含 `Duckov.exe` 的目录

### 步骤 3：安装 Mod

**方式 A：使用部署脚本（推荐）**

1. 解压 Mod 压缩包到任意位置
2. 编辑 `deploy.bat` 文件
3. 修改第 10 行的游戏路径：
   ```batch
   set "GAME_PATH=你的游戏路径"
   ```
4. 保存并双击运行 `deploy.bat`
5. 等待脚本完成

**方式 B：手动安装**

1. 解压 Mod 压缩包
2. 打开游戏目录
3. 进入 `Duckov_Data\Mods\` 文件夹
   - 如果 `Mods` 文件夹不存在，手动创建
4. 将 `RunWhileEating` 文件夹复制到 `Mods` 文件夹
5. 最终路径应为：
   ```
   {游戏目录}\Duckov_Data\Mods\RunWhileEating\
   ```

### 步骤 4：启用 Mod

1. **启动游戏**
2. **进入 Mods 菜单**
   - 主菜单 → Mods
3. **找到并启用**
   - 找到"吃东西时可以跑"
   - 点击启用（打勾）
4. **重启游戏**
   - 返回主菜单
   - 退出游戏
   - 重新启动

### 步骤 5：验证安装

进入游戏后：
1. 按 **F11** 查看 Mod 状态
2. 日志中应显示：
   ```
   [RunWhileEating] === RunWhileEating Mod 开始初始化 ===
   [RunWhileEating] ✓ Harmony Patches 应用成功
   ```

---

## 功能说明

### 核心功能

**移除移动限制**
- 使用食物时可以跑动
- 使用药品时可以跑动
- 使用饮料时可以跑动
- 使用任何消耗品时可以跑动

**速度设置**
- 保持 100% 正常跑步速度
- 无任何速度惩罚
- 和平时跑步完全一样

### 支持的物品类型

- ✅ **食物** - 面包、肉类、罐头等
- ✅ **药品** - 绷带、急救包、药剂等
- ✅ **饮料** - 水、饮料、能量饮料等
- ✅ **其他消耗品** - 所有可使用的消耗品

---

## 调试功能

### 快捷键

| 按键 | 功能 | 说明 |
|------|------|------|
| **F11** | 显示 Mod 状态 | 查看 Mod 是否正常运行、Patch 数量等 |

### 状态信息示例

按 F11 后，日志中会显示：
```
=== RunWhileEating Mod 状态 ===
Mod 版本: 1.0
Harmony ID: com.sanye.runwhileeating
监控状态: 运行中
调试模式: 开启
玩家对象: 找到
==============================
```

### 查看日志

**日志位置**：
```
%USERPROFILE%\AppData\LocalLow\TeamSoda\Duckov\Player.log
```

**快速打开**：
1. 按 `Win + R`
2. 输入：`%USERPROFILE%\AppData\LocalLow\TeamSoda\Duckov`
3. 打开 `Player.log`

**搜索关键词**：
```
[RunWhileEating]
```

---

## 常见问题

### Q1: Mod 不显示在游戏中

**可能原因**：
- 文件夹名称不正确
- 放置位置不正确
- 缺少必需文件

**解决方法**：
1. 确认文件夹名称为 `RunWhileEating`
2. 确认路径为 `{游戏目录}\Duckov_Data\Mods\RunWhileEating\`
3. 检查文件夹内是否包含：
   - `RunWhileEating.dll`
   - `0Harmony.dll`
   - `info.ini`

### Q2: 功能不生效

**排查步骤**：

**步骤 1：确认 Mod 已启用**
- 游戏内 Mods 菜单中是否打勾
- 是否重启过游戏

**步骤 2：查看 Mod 状态**
- 游戏中按 F11
- 查看是否显示状态信息

**步骤 3：检查日志**
1. 打开 `Player.log`
2. 搜索 `[RunWhileEating]`
3. 查看是否有错误信息

**步骤 4：尝试重新安装**
1. 删除 Mod 文件夹
2. 重新复制
3. 重启游戏

### Q3: 游戏崩溃或卡顿

**可能原因**：
- Mod 冲突
- 游戏版本不兼容
- 其他问题

**解决方法**：

**排查 Mod 冲突**：
1. 禁用所有其他 Mod
2. 只启用 RunWhileEating
3. 如果正常，逐个启用其他 Mod 找出冲突

**检查游戏版本**：
- 确认游戏版本 ≥ v1.0.26
- 如果版本过旧，更新游戏

**查看崩溃日志**：
- 打开 `Player.log`
- 查看崩溃时的错误信息
- 将错误信息反馈到 GitHub

### Q4: 速度似乎没有变化

**可能情况**：
1. 游戏原版可能已经允许慢速移动
2. Mod 移除的是"完全禁止移动"的限制
3. 效果在不同物品上可能不同

**验证方法**：
1. 使用需要较长时间的消耗品
2. 观察是否可以正常跑动
3. 对比原版和 Mod 版本的差异

### Q5: 按键没反应（F11）

**可能原因**：
- 其他软件占用了 F11 快捷键
- Mod 未正确加载

**解决方法**：
1. 检查 Mod 是否正常加载（查看日志）
2. 尝试关闭其他可能冲突的软件
3. 不影响主要功能，只是调试功能无法使用

---

## 进阶说明

### 工作原理

**技术实现**：
1. 使用 Harmony 框架进行运行时方法 Patch
2. 拦截游戏的移动限制检查
3. 强制允许移动状态
4. 保持正常跑步速度

**Patch 策略**：
- 通用兜底策略：实时强制允许移动
- 未来版本：精确 Patch 游戏方法（需反编译）

### 性能影响

**CPU 占用**：
- 极小，几乎无影响
- Update 方法中的检查非常轻量

**内存占用**：
- Mod DLL: ~10 KB
- Harmony DLL: ~2.4 MB
- 运行时内存: < 1 MB

### 兼容性

**已知兼容**：
- 大部分其他 Mod
- 不修改移动系统的 Mod

**可能冲突**：
- 修改角色移动速度的 Mod
- 修改物品使用机制的 Mod
- 修改 CharacterController 的 Mod

### 卸载

**完全卸载步骤**：
1. 游戏内 Mods 菜单禁用
2. 重启游戏
3. 删除 Mod 文件夹：
   ```
   {游戏目录}\Duckov_Data\Mods\RunWhileEating\
   ```
4. 再次重启游戏

---

## 更新日志

### v1.0 (2025-11-27)
- 首次发布
- 实现基础功能
- 支持所有消耗品
- 包含调试功能

---

## 反馈和支持

### 问题反馈

**GitHub Issues**:
https://github.com/plantes/duckov_modding/issues

**反馈时请提供**：
1. 游戏版本
2. Mod 版本
3. 问题描述
4. 复现步骤
5. 日志文件（如有）

### 功能建议

欢迎提出新功能建议！

**可能的未来功能**：
- 配置文件支持
- 自定义速度倍率
- 分别控制不同物品类型
- 更精确的游戏方法 Patch

---

## 附录

### 文件清单

```
RunWhileEating/
├── RunWhileEating.dll         # 主程序 (~10 KB)
├── 0Harmony.dll               # Harmony 库 (~2.4 MB)
└── info.ini                   # Mod 信息 (~1 KB)
```

### 技术栈

- **语言**: C#
- **框架**: .NET Standard 2.1
- **依赖**:
  - Lib.Harmony 2.4.1
  - Unity Engine (游戏自带)

### 编译信息

- **编译器**: .NET SDK 8.0+
- **目标框架**: netstandard2.1
- **优化**: Release 配置

---

**祝你游戏愉快！** 🎮

如有任何问题，随时查阅本文档或联系作者。
